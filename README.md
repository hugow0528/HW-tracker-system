# 功課追蹤平台 (Homework Tracker) 

這是一個基於 Google Apps Script 開發的網頁應用程式，旨在幫助老師輕鬆記錄、查看及管理學生缺交功課的情況。系統將數據集中儲存，並提供一個按年級劃分、可篩選的儀表板介面。


## ✨ 主要功能

*   **儀表板介面**：提供一個現代化、響應式的網頁介面，方便在不同裝置上查看缺交記錄。
*   **分年級檢視**：主頁允許使用者選擇特定年級，只顯示相關數據，保持介面整潔。
*   **學生記錄卡片**：自動將每個學生的缺交記錄歸納到一張卡片中，並顯示總次數，一目了然。
*   **強大的篩選功能**：可以根據「班別」、「學號」及「科目」快速篩選，精準找到所需記錄。
*   **便捷的數據輸入**：透過自動產生的 Google Form 進行數據輸入，表單會根據所選班級動態顯示對應的學生名單。
*   **簡易的記錄刪除**：在網頁介面上，每筆記錄旁都有刪除按鈕，可即時移除錯誤的記錄。
*   **中央化學生名單管理**：所有學生名單統一由指定的 Google Sheet 管理，更新方便。

## 🔧 系統架構

本平台完全建構在 Google Workspace 生態系統之上：

*   **前端 (Frontend)**：`index.html` 檔案，使用 HTML、CSS 和 JavaScript 打造使用者操作介面。
*   **後端 (Backend)**：`Code.gs` 檔案，使用 Google Apps Script 編寫所有核心邏輯，包括數據處理、表單生成和網頁服務。
*   **數據輸入**：透過 Google Forms 收集數據。此表單由腳本自動建立和維護。
*   **學生名單來源**：一個指定的 Google Sheet，作為學生資料的唯一來源 (Single Source of Truth)。
*   **數據儲存**：所有缺交功課的記錄都以 JSON 格式儲存在 Script Properties 中，這是一種輕量級的鍵值對儲存方式，適合此應用規模。

## 👨‍🏫 使用者指南 (教師)

### 1. 查看缺交記錄
1.  開啟平台網址。
2.  在主畫面點擊您想查看的年級（例如「中四」）。
3.  進入該年級的儀表板後，您會看到所有缺交記錄，並已按學生分組。
4.  使用上方的篩選器（班別、學號、科目）來縮小搜尋範圍。
5.  點擊右上角的「刷新資料」按鈕可隨時獲取最新數據。

### 2. 新增缺交記錄
1.  在年級儀表板頁面，點擊右上角的「**開啟記錄表單**」按鈕。
2.  這會在新分頁中打開一個 Google Form。
3.  **第一步**：選擇年級。
4.  **第二步**：選擇班別。
5.  **第三步**：表單會跳轉至該班級的專屬頁面，請填寫「科目」、「功課名稱」、「缺交日期」，並勾選所有缺交功課的學生。
6.  提交表單即可。數據將會自動同步到平台。

### 3. 刪除缺交記錄
1.  在儀表板的學生卡片中，找到您想刪除的單筆記錄。
2.  點擊該記錄右側的垃圾桶圖示按鈕。
3.  在跳出的確認視窗中點擊「確定」，該筆記錄將被永久刪除。

## 🛠️ 管理員指南 (設定與維護)

作為系統的管理員，您需要透過 Google Apps Script 編輯器來進行首次設定和後續的學生名單更新。

### 前置作業：準備學生名單
請確保您的 Google Sheet  包含一個名為 `2526 Class List` 的分頁，且格式如下 (A-D欄)：

| 班別  | 學號  | 英文姓名  | 中文姓名 |
| :----------: | :-----------: | :---------------------: | :---------------------: |
|      1A      |       1       |        Chan Tai Man     |          陳大文         |
|      1A      |       2       |        Lee Siu Ming     |          李小明         |
|      1B      |       1       |        Wong Ka Po       |          王家寶         |
|     ...      |      ...      |           ...           |           ...           |

### 步驟一：首次安裝
1.  開啟 `Code.gs` 檔案的 Apps Script 編輯器。
2.  在函式列表中，選擇並執行 `RUN_THIS_FIRST_TO_SETUP`。
3.  此函式會：
    *   自動建立一個全新的、分頁式的 Google Form 用於數據輸入。
    *   儲存表單 ID。
    *   設定一個 `onFormSubmit` 觸發器，以便在每次提交表單時自動處理數據。
4.  執行成功後，日誌 (Logs) 中會顯示成功訊息。

### 步驟二：取得表單網址
1.  執行完步驟一後，在函式列表中選擇並執行 `RUN_THIS_TO_GET_FORM_URL`。
2.  查看執行日誌 (Execution log)，您會找到一個 Google Form 的公開網址。
3.  請將此網址分享給所有需要輸入缺交記錄的老師。

### 日常維護：更新學生名單
當新學年開始或學生資料有變動時（例如插班、退學），請依照以下步驟更新系統：

1.  **首先**，直接在您的 Google Sheet (`2526 Class List`) 中更新學生名單。
2.  **然後**，返回 Apps Script 編輯器，執行 `RUN_THIS_TO_UPDATE_FORM` 函式。
    *   此函式會讀取最新的學生名單，並自動更新 Google Form 中所有班級的學生勾選列表。
    *   **這不會改變您現有的表單網址**，老師們可以繼續使用舊的連結。
3.  **(可選)** 如果您想立即讓網頁介面也顯示最新的學生姓名（而不是等快取過期），可以執行 `CLEAR_SCRIPT_CACHE` 函式。

## ⚙️ 程式碼設定

所有可配置的參數都集中在 `Code.gs` 檔案的頂部，方便進行客製化。

*   `SPREADSHEET_ID`: 存放學生名單的 Google Sheet ID。
*   `SHEET_NAME`: 學生名單所在的分頁名稱。
*   `CLASSES`: 學校的年級列表。
*   `SUB_CLASSES`: 每個年級的班別後綴。
*   `SUBJECTS_BY_GRADE`: 按年級劃分的科目列表。
*   `STUDENT_LIST_URLS`: 對應各年級學生名單 PDF 的外部連結。

---

*Copyright © 2025 Wong Tsz Him, Hugo. All rights reserved.*
